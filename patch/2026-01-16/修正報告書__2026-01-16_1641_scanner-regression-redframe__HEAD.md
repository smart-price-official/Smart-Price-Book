# 🔧 Smart Price 修正報告書

**TO**: ユイ（監督）、なべさん（実機検証）  
**FROM**: Rex  
**DATE(JST)**: 2026-01-16 16:41 JST  
**VERSION**: v19.9.18-hf28-p0-camera-lag  
**BUILD_ID**: 2026-01-16_1641_scanner-regression-redframe  
**SERIAL**: 2026-01-16_1641JST_scanner-regression-redframe  
**COMMIT**: HEAD（最新コミット・反映待ち）

---

## 📋 変更点（箇条書き）

### P0回帰修正

1. **トースト「カメラ起動中…」は表示しない**
   - 通常モードでは表示しない
   - debug=1のときだけ表示（デバッグ時に確認可能）

2. **スキャナ画面に「合わせ窓（角丸ガイド枠）」を必ず表示**
   - `display: block;` に変更（debug=1の条件を削除）
   - `z-index: 2001;` でvideoより前面に固定
   - 通常モードでも必ず表示

3. **スキャンバー（走査ライン）を必ず表示**
   - `z-index: 2002;` でvideoより前面に固定
   - CSSアニメで確実に表示（JS依存より安定）

4. **赤い枠の角丸Rを他カードと同じに統一**
   - `border-radius: 12px !important;` で他カード（`.card` の `border-radius: 12px`）と同じ半径に統一

5. **枠線に対して情報が近すぎるのを解消**
   - `padding: 12px !important;` で左右余白を追加
   - `margin: 0 !important;` を追加（マージンをリセット）

---

## ✅ 受け入れ条件

### スキャナ
- ✅ 窓あり（角丸ガイド枠が表示される）
- ✅ バーあり（スキャンバーが表示される）
- ✅ 起動トースト無し（通常モードでは「カメラ起動中…」は表示されない）

### 赤枠
- ✅ 角丸が他と一致（`border-radius: 12px` で他カードと同じ）
- ✅ 内側余白が増えて詰まり感が消える（`padding: 12px` で左右余白が追加）

---

## 🧪 検証手順

### A. 前提チェック（最優先）

**確認項目**: 実機側で検証URLを開いた時に、**画面上のVERSIONが `v19.9.18` になっていること**

**最新版確認方法**: **UIのバージョン表示**を確認：
- 画面上部の `VERSION: v19.9.18` が表示されていること
- `debug=1` で `BUILD_ID: 2026-01-16_1641_scanner-regression-redframe` が表示されること

**「動いてない」報告時の確認手順（定型化・テンプレ化）**:
1. **まず確認するのは"UIのバージョン表示"**
   - 画面のVERSION/BUILDが古いまま＝キャッシュかURL違い
2. **画面ヘッダの DATE/BUILD_ID が一致しているか確認させる**
3. 一致してなければ **キャッシュ側**が原因 → 定型手順で対処（**必ずこの順番で案内**）
   - **通常タブで開く** → だめなら**サイトデータ削除（smart-price-official.github.io）** → それでもだめなら**PWA削除→再追加**

---

### B. スキャナガイド枠の確認

**テスト手順**:
1. スキャンボタンを押す
2. 角丸ガイド枠が表示されることを確認（通常モードでも）
3. スキャンバー（走査ライン）が表示されることを確認
4. 「カメラ起動中…」トーストが表示されないことを確認

**期待結果**:
- 通常モードでも角丸ガイド枠が必ず表示される
- スキャンバー（走査ライン）が必ず表示される
- 合わせ窓の中を走るように動作
- 通常モードでは「カメラ起動中…」トーストは表示されない

**スクショ依頼**:
- スキャン画面を開いたときのスクショ（角丸ガイド枠とスキャンバーが表示されていること）

---

### C. 赤枠の確認

**テスト手順**:
1. 購入履歴から商品を選択
2. 赤枠が他カードと同じ角丸になっていることを確認
3. 枠線に対して情報が近すぎないことを確認（左右余白が追加されていること）

**期待結果**:
- 角丸が他カードと同じ `border-radius: 12px` になっている
- 左右余白（`padding: 12px`）が追加され、枠線に対して情報が近すぎない
- "このページ（価格入力の枠）"と同じ見た目の統一感

**スクショ依頼**:
- 購入履歴から商品を選択したときのスクショ（赤枠が正しく表示されていること）

---

## 🔗 検証URL（BUILD_ID完全一致）

**通常URL**:
```
https://smart-price-official.github.io/Smart-Price-Book/dev/?b=2026-01-16_1641_scanner-regression-redframe
```

**デバッグURL**:
```
https://smart-price-official.github.io/Smart-Price-Book/dev/?b=2026-01-16_1641_scanner-regression-redframe&debug=1
```

**最新版確認方法**: 実機で上記URLを開いた時に、**UIのバージョン表示**を確認：
- 画面上部の `VERSION: v19.9.18` が表示されていること
- `debug=1` で `BUILD_ID: 2026-01-16_1641_scanner-regression-redframe` が表示されること

---

## 📝 注意事項

### ⚠️ スキャナガイド枠

- **必ず表示**: 通常モードでも角丸ガイド枠が必ず表示される（debug=1の条件を削除）
- **z-index固定**: videoより前面に固定され、確実に表示される

### ⚠️ スキャンバー（走査ライン）

- **z-index固定**: videoより前面に固定され、確実に表示される
- **CSSアニメ**: JS依存より安定した表示方式

### ⚠️ 赤枠の角丸/余白

- **角丸統一**: 他カードと同じ `border-radius: 12px` に統一
- **左右余白**: `padding: 12px !important` で枠線に対して情報が近すぎるのを解消
- **統一感**: "このページ（価格入力の枠）"と同じ見た目の統一感

---

**以上**
