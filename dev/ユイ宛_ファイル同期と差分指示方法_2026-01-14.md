# 📋 TO: ユイ（監督）

**FROM**: Rex  
**DATE(JST)**: 2026-01-14 17:40 JST  
**TITLE**: ファイル同期と差分ベースの修正指示方法

---

## 🎯 目的

**現状**: ファイルのやり取りが発生している  
**理想**: コードの差分で修正指示をしたい

→ **GitHub上の最新ファイルを基準に、差分ベースで指示できる環境を整える**

---

## 📂 現在のファイル配置

### ローカル（Cursorワークスペース）
```
g:\マイドライブ\Cursor\Smart Price\
└── Smart-Price-Book\
    ├── dev\                    ← ★デプロイ対象
    │   ├── index.html          ← v19.9.14（最新・編集済み）
    │   ├── config.json
    │   ├── manifest.json
    │   └── 修正報告書_*.md
    ├── index.html              ← 本番用（古い）
    └── README.md
```

### GitHub（リモートリポジトリ）
```
https://github.com/smart-price-official/Smart-Price-Book
└── dev\
    ├── index.html              ← ❓状態不明（push待ち）
    ├── config.json
    └── manifest.json
```

### GitHub Pages（公開URL）
```
https://smart-price-official.github.io/Smart-Price-Book/dev/
```

---

## 🔄 ファイル同期フロー（3ステップ）

### Step 1: ローカル編集（Rex担当）✅
```
[Rex] ローカルで index.html を編集
      ↓
[Rex] 修正報告書を作成
      ↓
[Rex] README.md を更新
```

### Step 2: GitHubへpush（ユーザー担当）⏳
```powershell
# Cursor内のターミナルで実行
cd "g:\マイドライブ\Cursor\Smart Price"
git add Smart-Price-Book/dev/index.html
git add Smart-Price-Book/dev/修正報告書_*.md
git add README.md
git commit -m "v19.9.14: デバッグログ追加"
git push origin main
```

### Step 3: GitHub Pages自動デプロイ（1-2分）🔄
```
[GitHub Actions] 自動ビルド・デプロイ
      ↓
[GitHub Pages] 更新完了
      ↓
[ユイ/なべさん] URLで確認可能
```

---

## 📝 差分ベースの修正指示方法（推奨）

### 方法A: GitHub上のファイルパス + 行番号指定

**ユイからの指示例**:
```
TO: Rex
FROM: ユイ
FILE: Smart-Price-Book/dev/index.html
LINE: 2557-2570

現在のコード:
------
      const requestUrl = `${proxyUrl}?jan=${encodeURIComponent(jan)}`;
      const res = await fetch(requestUrl, { 
        cache: 'no-store', 
        signal: controller.signal 
      });
------

修正内容:
------
      // ✅ CORSヘッダーを追加
      const requestUrl = `${proxyUrl}?jan=${encodeURIComponent(jan)}`;
      const res = await fetch(requestUrl, { 
        cache: 'no-store', 
        signal: controller.signal,
        mode: 'cors',
        credentials: 'omit'
      });
------

理由: CORS対策を強化
```

### 方法B: GitHubのPull Request機能（最も明確）

1. **ユイがGitHub上でファイルを直接編集**:
   ```
   https://github.com/smart-price-official/Smart-Price-Book/blob/main/Smart-Price-Book/dev/index.html
   ```
   
2. **「Edit this file」ボタンで編集**

3. **「Propose changes」で差分を自動生成**

4. **RexがPull Requestを確認・マージ**

---

## 🌐 確認用URL（ユイが参照するURL）

### 最新版の確認（GitHub Pages）
```
https://smart-price-official.github.io/Smart-Price-Book/dev/?b=2026-01-14_1728_rex-check&debug=1
```

### ソースコードの確認（GitHub）
```
https://github.com/smart-price-official/Smart-Price-Book/blob/main/Smart-Price-Book/dev/index.html
```

### 差分の確認（GitHub Commits）
```
https://github.com/smart-price-official/Smart-Price-Book/commits/main
```

---

## 📌 推奨ワークフロー（差分ベース）

### 🔄 日常的な修正（小規模）

1. **ユイ**: GitHub上のファイルを参照
   ```
   https://github.com/smart-price-official/Smart-Price-Book/blob/main/Smart-Price-Book/dev/index.html
   ```

2. **ユイ**: 差分指示を出す
   - ファイル名: `Smart-Price-Book/dev/index.html`
   - 行番号: `2557-2570`
   - 変更内容: （上記の例を参照）

3. **Rex**: ローカルで修正 → 修正報告書作成

4. **ユーザー**: GitHubにpush

5. **ユイ/なべさん**: GitHub Pagesで確認

---

### 🚀 大規模修正・検証（Pull Request）

1. **ユイ**: GitHub上で直接編集 or ブランチ作成

2. **ユイ**: Pull Requestを作成（差分が自動表示される）

3. **Rex**: レビュー・修正

4. **ユイ**: マージ承認

5. **GitHub Actions**: 自動デプロイ

---

## 🎯 次のアクション（ユーザーへ）

### 今すぐやること（v19.9.14のデプロイ）

Cursorのターミナルで以下を実行:

```powershell
cd "g:\マイドライブ\Cursor\Smart Price"

# 変更ファイルを確認
git status

# ファイルを追加
git add Smart-Price-Book/dev/index.html
git add Smart-Price-Book/dev/修正報告書_v19.9.14-hf24-debug-fetch.md
git add README.md

# コミット
git commit -m "v19.9.14: デバッグログ追加（Failed to fetch切り分け用）"

# プッシュ
git push origin main
```

### 確認（1-2分後）

以下のURLで動作確認:
```
https://smart-price-official.github.io/Smart-Price-Book/dev/?b=2026-01-14_1728_rex-check&debug=1
```

---

## 📝 まとめ

| 方法 | メリット | デメリット | 推奨度 |
|------|---------|-----------|--------|
| **差分指示（行番号）** | 簡潔・明確 | GitHubへのpushが必要 | ⭐⭐⭐⭐⭐ |
| **Pull Request** | 差分自動表示・レビュー可能 | 手順がやや複雑 | ⭐⭐⭐⭐ |
| **ファイル丸ごと** | 確実 | 差分が見えにくい | ⭐⭐ |

**推奨**: **差分指示（行番号）** + **定期的なGitHub push**

---

## 🔧 技術メモ

### GitHub上のファイル直接リンク（行番号付き）

```
https://github.com/smart-price-official/Smart-Price-Book/blob/main/Smart-Price-Book/dev/index.html#L2557-L2570
```

上記のように `#L2557-L2570` を付けると、該当行にジャンプできます。

### GitHubでの差分表示

コミット後、以下で差分を確認できます:
```
https://github.com/smart-price-official/Smart-Price-Book/commit/[コミットハッシュ]
```

---

## 📞 連絡事項

### 現在の状況

- ✅ ローカル編集完了（v19.9.14）
- ⏳ GitHubへのpush待ち
- ⏳ なべさんの検証待ち

### 次回以降の改善案

1. **GitHub Actionsで自動テスト**を追加
2. **Staging環境**（dev）と**本番環境**（main）の分離
3. **コミットメッセージ規約**の統一

---

以上、ご確認をお願いします。🚀
